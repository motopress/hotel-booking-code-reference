<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>MotoPress Hotel Booking Code Reference</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <base href="../">
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/base.css">
            <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">
        <link rel="stylesheet" href="css/template.css">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
                <script src="https://cdn.jsdelivr.net/npm/fuse.js@3.4.6"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/js/all.min.js" integrity="sha256-0vuk8LXoyrmCjp1f0O300qo1M75ZQyhH9X3J6d+scmk=" crossorigin="anonymous"></script>
    </head>
<body id="top">
    <header class="phpdocumentor-header">
    <div class="phpdocumentor-section">
        <nav class="phpdocumentor-topnav">
    <div class="site-branding">
        <a class="site-logo" href="index.html">MotoPress Hotel Booking Code Reference</a>
    </div>
    <ul class="phpdocumentor-topnav__menu">
        <li><a href="hooks/hooks.html">Hooks Reference</a></li>
                                    <li><a href="https://motopress.com/documentation/wordpress/plugins/hotel-booking/">Documetation</a></li>
                                                <li><a href="https://motopress.github.io/hotel-booking-rest-api/">REST API</a></li>
                                                                                    </ul>
</nav>

    </div>
</header>

<section data-search-form class="phpdocumentor-search">
    <div class="phpdocumentor-section">
        <label>
            <input type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading .." disabled />
        </label>
    </div>
</section>


    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <input class="phpdocumentor-sidebar__menu-button" type="checkbox" id="sidebar-button" name="sidebar-button" />
<label class="phpdocumentor-sidebar__menu-icon" for="sidebar-button">
    Menu
</label>

<aside class="phpdocumentor-column -three phpdocumentor-sidebar">

    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Namespaces</h2>
                                <h3 class="phpdocumentor-sidebar__root-namespace"><a href="namespaces/default.html"><abbr title="\">Global</abbr></a></h3>
                                        <h4 class="phpdocumentor-sidebar__root-namespace"><a href="namespaces/mphb.html"><abbr title="\MPHB">MPHB</abbr></a></h4>
                <ul class="phpdocumentor-list">
                                            <li><a href="namespaces/mphb-admin.html"><abbr title="\MPHB\Admin">Admin</abbr></a></li>
                                            <li><a href="namespaces/mphb-advanced.html"><abbr title="\MPHB\Advanced">Advanced</abbr></a></li>
                                            <li><a href="namespaces/mphb-ajaxapi.html"><abbr title="\MPHB\AjaxApi">AjaxApi</abbr></a></li>
                                            <li><a href="namespaces/mphb-bookingrules.html"><abbr title="\MPHB\BookingRules">BookingRules</abbr></a></li>
                                            <li><a href="namespaces/mphb-bundles.html"><abbr title="\MPHB\Bundles">Bundles</abbr></a></li>
                                            <li><a href="namespaces/mphb-core.html"><abbr title="\MPHB\Core">Core</abbr></a></li>
                                            <li><a href="namespaces/mphb-crons.html"><abbr title="\MPHB\Crons">Crons</abbr></a></li>
                                            <li><a href="namespaces/mphb-csv.html"><abbr title="\MPHB\CSV">CSV</abbr></a></li>
                                            <li><a href="namespaces/mphb-emails.html"><abbr title="\MPHB\Emails">Emails</abbr></a></li>
                                            <li><a href="namespaces/mphb-entities.html"><abbr title="\MPHB\Entities">Entities</abbr></a></li>
                                            <li><a href="namespaces/mphb-exceptions.html"><abbr title="\MPHB\Exceptions">Exceptions</abbr></a></li>
                                            <li><a href="namespaces/mphb-payments.html"><abbr title="\MPHB\Payments">Payments</abbr></a></li>
                                            <li><a href="namespaces/mphb-persistences.html"><abbr title="\MPHB\Persistences">Persistences</abbr></a></li>
                                            <li><a href="namespaces/mphb-posttypes.html"><abbr title="\MPHB\PostTypes">PostTypes</abbr></a></li>
                                            <li><a href="namespaces/mphb-reports.html"><abbr title="\MPHB\Reports">Reports</abbr></a></li>
                                            <li><a href="namespaces/mphb-repositories.html"><abbr title="\MPHB\Repositories">Repositories</abbr></a></li>
                                            <li><a href="namespaces/mphb-scriptmanagers.html"><abbr title="\MPHB\ScriptManagers">ScriptManagers</abbr></a></li>
                                            <li><a href="namespaces/mphb-settings.html"><abbr title="\MPHB\Settings">Settings</abbr></a></li>
                                            <li><a href="namespaces/mphb-shortcodes.html"><abbr title="\MPHB\Shortcodes">Shortcodes</abbr></a></li>
                                            <li><a href="namespaces/mphb-taxesandfees.html"><abbr title="\MPHB\TaxesAndFees">TaxesAndFees</abbr></a></li>
                                            <li><a href="namespaces/mphb-upgrades.html"><abbr title="\MPHB\Upgrades">Upgrades</abbr></a></li>
                                            <li><a href="namespaces/mphb-useractions.html"><abbr title="\MPHB\UserActions">UserActions</abbr></a></li>
                                            <li><a href="namespaces/mphb-usersandroles.html"><abbr title="\MPHB\UsersAndRoles">UsersAndRoles</abbr></a></li>
                                            <li><a href="namespaces/mphb-utils.html"><abbr title="\MPHB\Utils">Utils</abbr></a></li>
                                            <li><a href="namespaces/mphb-views.html"><abbr title="\MPHB\Views">Views</abbr></a></li>
                                            <li><a href="namespaces/mphb-widgets.html"><abbr title="\MPHB\Widgets">Widgets</abbr></a></li>
                                    </ul>
                        </section>

        <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Packages</h2>
                    <h3 class="phpdocumentor-sidebar__root-package"><a href="packages/MPHB.html"><abbr title="\MPHB">MPHB</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="packages/MPHB-Advanced.html"><abbr title="\MPHB\Advanced">Advanced</abbr></a></li>
                                    <li><a href="packages/MPHB-Entities.html"><abbr title="\MPHB\Entities">Entities</abbr></a></li>
                            </ul>
                        </section>
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="indices/files.html">Files</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="hooks/hooks.html">Hooks</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -nine phpdocumentor-content">
                    <ul class="phpdocumentor-breadcrumbs">
            <li class="phpdocumentor-breadcrumb"><a href="namespaces/mphb.html">MPHB</a></li>
            <li class="phpdocumentor-breadcrumb"><a href="namespaces/mphb-advanced.html">Advanced</a></li>
            <li class="phpdocumentor-breadcrumb"><a href="namespaces/mphb-advanced-api.html">Api</a></li>
    </ul>

    <article class="phpdocumentor-element -class">
        <h2 class="phpdocumentor-content__title">
    ApiAuthentication

    
            <div class="phpdocumentor-element__package">
            in package
            <ul class="phpdocumentor-breadcrumbs">
                                    <li class="phpdocumentor-breadcrumb"><a href="packages/MPHB.html">MPHB</a></li>
                                    <li class="phpdocumentor-breadcrumb"><a href="packages/MPHB-Advanced.html">Advanced</a></li>
                                    <li class="phpdocumentor-breadcrumb"><a href="packages/MPHB-Advanced-Api.html">Api</a></li>
                            </ul>
        </div>
    
    
    </h2>

        <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">25</span>
</aside>

        








<h3 id="toc">
    Table of Contents
    <a href="#toc" class="headerlink"><i class="fas fa-link"></i></a>
</h3>

<dl class="phpdocumentor-table-of-contents">
                <dt class="phpdocumentor-table-of-contents__entry -property -protected">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#property_authMethod">$authMethod</a>
    <span>
                &nbsp;: string            </span>
</dt>
<dd>Current auth method.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -property -protected">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#property_error">$error</a>
    <span>
                &nbsp;: <abbr title="\WP_Error">WP_Error</abbr>            </span>
</dt>
<dd>Authentication error.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -property -protected">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#property_user">$user</a>
    <span>
                &nbsp;: <abbr title="\stdClass">stdClass</abbr>            </span>
</dt>
<dd>Logged in user data.</dd>

                <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method___construct">__construct()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Initialize authentication actions.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_authenticate">authenticate()</a>
    <span>
                        &nbsp;: int|false    </span>
</dt>
<dd>Authenticate user.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_authenticationFallback">authenticationFallback()</a>
    <span>
                        &nbsp;: <abbr title="\WP_Error">WP_Error</abbr>|null|bool    </span>
</dt>
<dd>Authenticate the user if authentication wasn&#039;t performed during the
determine_current_user action.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_checkAuthenticationError">checkAuthenticationError()</a>
    <span>
                        &nbsp;: <abbr title="\WP_Error">WP_Error</abbr>|null|bool    </span>
</dt>
<dd>Check for authentication error.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_checkUserPermissions">checkUserPermissions()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Check for user permissions and register last access.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_getAuthorizationHeader">getAuthorizationHeader()</a>
    <span>
                        &nbsp;: string    </span>
</dt>
<dd>Get the authorization header.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_getCurrentAuthKeyId">getCurrentAuthKeyId()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd></dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_getOauthParameters">getOauthParameters()</a>
    <span>
                        &nbsp;: array&lt;string|int, mixed&gt;|<abbr title="\WP_Error">WP_Error</abbr>    </span>
</dt>
<dd>Get oAuth parameters from $_GET, $_POST or request header.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_parseHeader">parseHeader()</a>
    <span>
                        &nbsp;: array&lt;string|int, mixed&gt;    </span>
</dt>
<dd>Parse the Authorization header into parameters.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -public">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_sendUnauthorizedHeaders">sendUnauthorizedHeaders()</a>
    <span>
                        &nbsp;: <abbr title="\WP_REST_Response">WP_REST_Response</abbr>    </span>
</dt>
<dd>If the consumer_key and consumer_secret $_GET parameters are NOT provided
and the Basic auth headers are either not present or the consumer secret does not match the consumer
key provided, then return the correct Basic headers and an error message.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -protected">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_getError">getError()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Get authentication error.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -protected">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_isRequestToRestApi">isRequestToRestApi()</a>
    <span>
                        &nbsp;: bool    </span>
</dt>
<dd>Check if is request to our REST API.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -protected">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_setError">setError()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Set authentication error.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -private">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_checkOauthSignature">checkOauthSignature()</a>
    <span>
                        &nbsp;: true|<abbr title="\WP_Error">WP_Error</abbr>    </span>
</dt>
<dd>Verify that the consumer-provided request signature matches our generated signature,
this ensures the consumer has a valid key/secret.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -private">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_checkOauthTimestampAndNonce">checkOauthTimestampAndNonce()</a>
    <span>
                        &nbsp;: bool|<abbr title="\WP_Error">WP_Error</abbr>    </span>
</dt>
<dd>Verify that the timestamp and nonce provided with the request are valid. This prevents replay attacks where
an attacker could attempt to re-send an intercepted request at a later time.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -private">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_checkPermissions">checkPermissions()</a>
    <span>
                        &nbsp;: bool|<abbr title="\WP_Error">WP_Error</abbr>    </span>
</dt>
<dd>Check that the API keys provided have the proper key-specific permissions to either read or write API resources.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -private">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_getUserDataByConsumerKey">getUserDataByConsumerKey()</a>
    <span>
                        &nbsp;: <abbr title="\stdClass">stdClass</abbr>    </span>
</dt>
<dd>Return the user data for the given consumer_key.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -private">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_joinWithEqualsSign">joinWithEqualsSign()</a>
    <span>
                        &nbsp;: string    </span>
</dt>
<dd>Creates an array of urlencoded strings out of each array key/value pairs.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -private">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_normalizeParameters">normalizeParameters()</a>
    <span>
                        &nbsp;: array&lt;string|int, mixed&gt;    </span>
</dt>
<dd>Normalize each parameter by assuming each parameter may have already been
encoded, so attempt to decode, and then re-encode according to RFC 3986.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -private">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_performBasicAuthentication">performBasicAuthentication()</a>
    <span>
                        &nbsp;: int|bool    </span>
</dt>
<dd>Basic Authentication.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -private">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_performOauthAuthentication">performOauthAuthentication()</a>
    <span>
                        &nbsp;: int|bool    </span>
</dt>
<dd>Perform OAuth 1.0a &quot;one-legged&quot; (http://oauthbible.com/#oauth-10a-one-legged) authentication for non-SSL requests.</dd>

            <dt class="phpdocumentor-table-of-contents__entry -method -private">
    <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_updateLastAccess">updateLastAccess()</a>
    <span>
                        &nbsp;: mixed    </span>
</dt>
<dd>Updated API Key last access datetime.</dd>

        </dl>



        

        
    <section class="phpdocumentor-properties">
        <h3 class="phpdocumentor-elements__header" id="properties">
            Properties
            <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#properties" class="headerlink"><i class="fas fa-link"></i></a>
        </h3>
                    <article
        class="
            phpdocumentor-element
            -property
            -protected
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="property_authMethod">
        $authMethod
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#property_authMethod" class="headerlink"><i class="fas fa-link"></i></a>
        <span class="phpdocumentor-element__modifiers">
                                </span>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">46</span>
</aside>

        <p class="phpdocumentor-summary">Current auth method.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">protected</span>
        <span class="phpdocumentor-signature__type">string</span>
    <span class="phpdocumentor-signature__name">$authMethod</span>
     = <span class="phpdocumentor-signature__default-value">&#039;&#039;</span></code>

        <section class="phpdocumentor-description"></section>

    

</article>
                    <article
        class="
            phpdocumentor-element
            -property
            -protected
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="property_error">
        $error
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#property_error" class="headerlink"><i class="fas fa-link"></i></a>
        <span class="phpdocumentor-element__modifiers">
                                </span>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">32</span>
</aside>

        <p class="phpdocumentor-summary">Authentication error.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">protected</span>
        <span class="phpdocumentor-signature__type"><abbr title="\WP_Error">WP_Error</abbr></span>
    <span class="phpdocumentor-signature__name">$error</span>
     = <span class="phpdocumentor-signature__default-value">null</span></code>

        <section class="phpdocumentor-description"></section>

    

</article>
                    <article
        class="
            phpdocumentor-element
            -property
            -protected
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="property_user">
        $user
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#property_user" class="headerlink"><i class="fas fa-link"></i></a>
        <span class="phpdocumentor-element__modifiers">
                                </span>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">39</span>
</aside>

        <p class="phpdocumentor-summary">Logged in user data.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">protected</span>
        <span class="phpdocumentor-signature__type"><abbr title="\stdClass">stdClass</abbr></span>
    <span class="phpdocumentor-signature__name">$user</span>
     = <span class="phpdocumentor-signature__default-value">null</span></code>

        <section class="phpdocumentor-description"></section>

    

</article>
            </section>

            <section class="phpdocumentor-methods">
        <h3 class="phpdocumentor-elements__header" id="methods">
            Methods
            <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#methods" class="headerlink"><i class="fas fa-link"></i></a>
        </h3>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method___construct">
        __construct()
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method___construct" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">51</span>
</aside>

        <p class="phpdocumentor-summary">Initialize authentication actions.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
                <span class="phpdocumentor-signature__name">__construct</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"></section>

    
    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">mixed</span>
            &mdash;
            <section class="phpdocumentor-description"></section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_authenticate">
        authenticate()
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_authenticate" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">85</span>
</aside>

        <p class="phpdocumentor-summary">Authenticate user.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
                <span class="phpdocumentor-signature__name">authenticate</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">int|false&nbsp;</span><span class="phpdocumentor-signature__argument__name">$userId</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">int|false</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$userId</span>
                : <span class="phpdocumentor-signature__argument__return-type">int|false</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>User ID if one has been determined, false otherwise.</p>
</section>

            </dd>
            </dl>

    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">int|false</span>
            &mdash;
            <section class="phpdocumentor-description"></section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_authenticationFallback">
        authenticationFallback()
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_authenticationFallback" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">111</span>
</aside>

        <p class="phpdocumentor-summary">Authenticate the user if authentication wasn&#039;t performed during the
determine_current_user action.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
                <span class="phpdocumentor-signature__name">authenticationFallback</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type"><abbr title="\WP_Error">WP_Error</abbr>|null|bool&nbsp;</span><span class="phpdocumentor-signature__argument__name">$error</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type"><abbr title="\WP_Error">WP_Error</abbr>|null|bool</span></code>

        <section class="phpdocumentor-description"><p>Necessary in cases where wp_get_current_user() is called before Motopress hotel booking is loaded.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$error</span>
                : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\WP_Error">WP_Error</abbr>|null|bool</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Error data.</p>
</section>

            </dd>
            </dl>

    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type"><abbr title="\WP_Error">WP_Error</abbr>|null|bool</span>
            &mdash;
            <section class="phpdocumentor-description"></section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_checkAuthenticationError">
        checkAuthenticationError()
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_checkAuthenticationError" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">135</span>
</aside>

        <p class="phpdocumentor-summary">Check for authentication error.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
                <span class="phpdocumentor-signature__name">checkAuthenticationError</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type"><abbr title="\WP_Error">WP_Error</abbr>|null|bool&nbsp;</span><span class="phpdocumentor-signature__argument__name">$error</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type"><abbr title="\WP_Error">WP_Error</abbr>|null|bool</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$error</span>
                : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\WP_Error">WP_Error</abbr>|null|bool</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Error data.</p>
</section>

            </dd>
            </dl>

    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type"><abbr title="\WP_Error">WP_Error</abbr>|null|bool</span>
            &mdash;
            <section class="phpdocumentor-description"></section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_checkUserPermissions">
        checkUserPermissions()
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_checkUserPermissions" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">628</span>
</aside>

        <p class="phpdocumentor-summary">Check for user permissions and register last access.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
                <span class="phpdocumentor-signature__name">checkUserPermissions</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">mixed&nbsp;</span><span class="phpdocumentor-signature__argument__name">$result</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type"><abbr title="\WP_REST_Server">WP_REST_Server</abbr>&nbsp;</span><span class="phpdocumentor-signature__argument__name">$server</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type"><abbr title="\WP_REST_Request">WP_REST_Request</abbr>&nbsp;</span><span class="phpdocumentor-signature__argument__name">$request</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$result</span>
                : <span class="phpdocumentor-signature__argument__return-type">mixed</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Response to replace the requested version with.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$server</span>
                : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\WP_REST_Server">WP_REST_Server</abbr></span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Server instance.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$request</span>
                : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\WP_REST_Request">WP_REST_Request</abbr></span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Request used to generate the response.</p>
</section>

            </dd>
            </dl>

    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">mixed</span>
            &mdash;
            <section class="phpdocumentor-description"></section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_getAuthorizationHeader">
        getAuthorizationHeader()
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_getAuthorizationHeader" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">249</span>
</aside>

        <p class="phpdocumentor-summary">Get the authorization header.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
                <span class="phpdocumentor-signature__name">getAuthorizationHeader</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string</span></code>

        <section class="phpdocumentor-description"><p>On certain systems and configurations, the Authorization header will be
stripped out by the server or PHP. Typically this is then used to
generate <code class="prettyprint">PHP_AUTH_USER</code>/<code class="prettyprint">PHP_AUTH_PASS</code> but not passed on. We use
<code class="prettyprint">getallheaders</code> here to try and grab it out instead.</p>
</section>

    
    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">string</span>
            &mdash;
            <section class="phpdocumentor-description"><p>Authorization header if set.</p>
</section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_getCurrentAuthKeyId">
        getCurrentAuthKeyId()
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_getCurrentAuthKeyId" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">643</span>
</aside>

    
    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
                <span class="phpdocumentor-signature__name">getCurrentAuthKeyId</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

    
    
    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">mixed</span>
            &mdash;
            <section class="phpdocumentor-description"></section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_getOauthParameters">
        getOauthParameters()
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_getOauthParameters" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">272</span>
</aside>

        <p class="phpdocumentor-summary">Get oAuth parameters from $_GET, $_POST or request header.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
                <span class="phpdocumentor-signature__name">getOauthParameters</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">array&lt;string|int, mixed&gt;|<abbr title="\WP_Error">WP_Error</abbr></span></code>

        <section class="phpdocumentor-description"></section>

    
    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">array&lt;string|int, mixed&gt;|<abbr title="\WP_Error">WP_Error</abbr></span>
            &mdash;
            <section class="phpdocumentor-description"></section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_parseHeader">
        parseHeader()
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_parseHeader" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">220</span>
</aside>

        <p class="phpdocumentor-summary">Parse the Authorization header into parameters.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
                <span class="phpdocumentor-signature__name">parseHeader</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$header</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">array&lt;string|int, mixed&gt;</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$header</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Authorization header value (not including &quot;Authorization: &quot; prefix).</p>
</section>

            </dd>
            </dl>

    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">array&lt;string|int, mixed&gt;</span>
            &mdash;
            <section class="phpdocumentor-description"><p>Map of parameter values.</p>
</section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -public
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_sendUnauthorizedHeaders">
        sendUnauthorizedHeaders()
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_sendUnauthorizedHeaders" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">611</span>
</aside>

        <p class="phpdocumentor-summary">If the consumer_key and consumer_secret $_GET parameters are NOT provided
and the Basic auth headers are either not present or the consumer secret does not match the consumer
key provided, then return the correct Basic headers and an error message.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">public</span>
                <span class="phpdocumentor-signature__name">sendUnauthorizedHeaders</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type"><abbr title="\WP_REST_Response">WP_REST_Response</abbr>&nbsp;</span><span class="phpdocumentor-signature__argument__name">$response</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type"><abbr title="\WP_REST_Response">WP_REST_Response</abbr></span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$response</span>
                : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\WP_REST_Response">WP_REST_Response</abbr></span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Current response being served.</p>
</section>

            </dd>
            </dl>

    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type"><abbr title="\WP_REST_Response">WP_REST_Response</abbr></span>
            &mdash;
            <section class="phpdocumentor-description"></section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -protected
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_getError">
        getError()
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_getError" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">161</span>
</aside>

        <p class="phpdocumentor-summary">Get authentication error.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">protected</span>
                <span class="phpdocumentor-signature__name">getError</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"></section>

    
    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">mixed</span>
            &mdash;
            <section class="phpdocumentor-description"></section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -protected
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_isRequestToRestApi">
        isRequestToRestApi()
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_isRequestToRestApi" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">64</span>
</aside>

        <p class="phpdocumentor-summary">Check if is request to our REST API.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">protected</span>
                <span class="phpdocumentor-signature__name">isRequestToRestApi</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool</span></code>

        <section class="phpdocumentor-description"></section>

    
    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">bool</span>
            &mdash;
            <section class="phpdocumentor-description"></section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -protected
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_setError">
        setError()
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_setError" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">149</span>
</aside>

        <p class="phpdocumentor-summary">Set authentication error.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">protected</span>
                <span class="phpdocumentor-signature__name">setError</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type"><abbr title="\WP_Error">WP_Error</abbr>&nbsp;</span><span class="phpdocumentor-signature__argument__name">$error</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$error</span>
                : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\WP_Error">WP_Error</abbr></span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Authentication error data.</p>
</section>

            </dd>
            </dl>

    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">mixed</span>
            &mdash;
            <section class="phpdocumentor-description"></section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -private
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_checkOauthSignature">
        checkOauthSignature()
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_checkOauthSignature" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">387</span>
</aside>

        <p class="phpdocumentor-summary">Verify that the consumer-provided request signature matches our generated signature,
this ensures the consumer has a valid key/secret.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">private</span>
                <span class="phpdocumentor-signature__name">checkOauthSignature</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type"><abbr title="\stdClass">stdClass</abbr>&nbsp;</span><span class="phpdocumentor-signature__argument__name">$user</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;&nbsp;</span><span class="phpdocumentor-signature__argument__name">$params</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">true|<abbr title="\WP_Error">WP_Error</abbr></span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$user</span>
                : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\stdClass">stdClass</abbr></span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>User data.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$params</span>
                : <span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>The request parameters.</p>
</section>

            </dd>
            </dl>

    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">true|<abbr title="\WP_Error">WP_Error</abbr></span>
            &mdash;
            <section class="phpdocumentor-description"></section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -private
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_checkOauthTimestampAndNonce">
        checkOauthTimestampAndNonce()
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_checkOauthTimestampAndNonce" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">489</span>
</aside>

        <p class="phpdocumentor-summary">Verify that the timestamp and nonce provided with the request are valid. This prevents replay attacks where
an attacker could attempt to re-send an intercepted request at a later time.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">private</span>
                <span class="phpdocumentor-signature__name">checkOauthTimestampAndNonce</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type"><abbr title="\stdClass">stdClass</abbr>&nbsp;</span><span class="phpdocumentor-signature__argument__name">$user</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">int&nbsp;</span><span class="phpdocumentor-signature__argument__name">$timestamp</span></span><span class="phpdocumentor-signature__argument"><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$nonce</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool|<abbr title="\WP_Error">WP_Error</abbr></span></code>

        <section class="phpdocumentor-description"><ul>
<li>A timestamp is valid if it is within 15 minutes of now.</li>
<li>A nonce is valid if it has not been used within the last 15 minutes.</li>
</ul>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$user</span>
                : <span class="phpdocumentor-signature__argument__return-type"><abbr title="\stdClass">stdClass</abbr></span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>User data.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$timestamp</span>
                : <span class="phpdocumentor-signature__argument__return-type">int</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>The unix timestamp for when the request was made.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$nonce</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>A unique (for the given user) 32 alphanumeric string, consumer-generated.</p>
</section>

            </dd>
            </dl>

    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">bool|<abbr title="\WP_Error">WP_Error</abbr></span>
            &mdash;
            <section class="phpdocumentor-description"></section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -private
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_checkPermissions">
        checkPermissions()
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_checkPermissions" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">560</span>
</aside>

        <p class="phpdocumentor-summary">Check that the API keys provided have the proper key-specific permissions to either read or write API resources.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">private</span>
                <span class="phpdocumentor-signature__name">checkPermissions</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$method</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">bool|<abbr title="\WP_Error">WP_Error</abbr></span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$method</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Request method.</p>
</section>

            </dd>
            </dl>

    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">bool|<abbr title="\WP_Error">WP_Error</abbr></span>
            &mdash;
            <section class="phpdocumentor-description"></section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -private
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_getUserDataByConsumerKey">
        getUserDataByConsumerKey()
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_getUserDataByConsumerKey" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">536</span>
</aside>

        <p class="phpdocumentor-summary">Return the user data for the given consumer_key.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">private</span>
                <span class="phpdocumentor-signature__name">getUserDataByConsumerKey</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$consumer_key</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type"><abbr title="\stdClass">stdClass</abbr></span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$consumer_key</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Consumer key.</p>
</section>

            </dd>
            </dl>

    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type"><abbr title="\stdClass">stdClass</abbr></span>
            &mdash;
            <section class="phpdocumentor-description"></section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -private
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_joinWithEqualsSign">
        joinWithEqualsSign()
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_joinWithEqualsSign" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">433</span>
</aside>

        <p class="phpdocumentor-summary">Creates an array of urlencoded strings out of each array key/value pairs.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">private</span>
                <span class="phpdocumentor-signature__name">joinWithEqualsSign</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;&nbsp;</span><span class="phpdocumentor-signature__argument__name">$params</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;&nbsp;</span><span class="phpdocumentor-signature__argument__name">$query_params</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">array()</span><span> ]</span></span><span class="phpdocumentor-signature__argument"><span>[</span><span>, </span><span class="phpdocumentor-signature__argument__return-type">string&nbsp;</span><span class="phpdocumentor-signature__argument__name">$key</span><span> = </span><span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span><span> ]</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">string</span></code>

        <section class="phpdocumentor-description"></section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$params</span>
                : <span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Array of parameters to convert.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$query_params</span>
                : <span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;</span>
                 = <span class="phpdocumentor-signature__argument__default-value">array()</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Array to extend.</p>
</section>

            </dd>
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$key</span>
                : <span class="phpdocumentor-signature__argument__return-type">string</span>
                 = <span class="phpdocumentor-signature__argument__default-value">&#039;&#039;</span>            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Optional Array key to append.</p>
</section>

            </dd>
            </dl>

    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">string</span>
            &mdash;
            <section class="phpdocumentor-description"><p>Array of urlencoded strings.</p>
</section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -private
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_normalizeParameters">
        normalizeParameters()
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_normalizeParameters" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">469</span>
</aside>

        <p class="phpdocumentor-summary">Normalize each parameter by assuming each parameter may have already been
encoded, so attempt to decode, and then re-encode according to RFC 3986.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">private</span>
                <span class="phpdocumentor-signature__name">normalizeParameters</span><span>(</span><span class="phpdocumentor-signature__argument"><span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;&nbsp;</span><span class="phpdocumentor-signature__argument__name">$parameters</span></span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">array&lt;string|int, mixed&gt;</span></code>

        <section class="phpdocumentor-description"><p>Note both the key and value is normalized so a filter param like:</p>
<p>'filter[period]' =&gt; 'week'</p>
<p>is encoded to:</p>
<p>'filter%255Bperiod%255D' =&gt; 'week'</p>
<p>This conforms to the OAuth 1.0a spec which indicates the entire query string
should be URL encoded.</p>
</section>

        <h5 class="phpdocumentor-argument-list__heading">Parameters</h5>
    <dl class="phpdocumentor-argument-list">
                    <dt class="phpdocumentor-argument-list__entry">
                <span class="phpdocumentor-signature__argument__name">$parameters</span>
                : <span class="phpdocumentor-signature__argument__return-type">array&lt;string|int, mixed&gt;</span>
                            </dt>
            <dd class="phpdocumentor-argument-list__definition">
                    <section class="phpdocumentor-description"><p>Un-normalized parameters.</p>
</section>

            </dd>
            </dl>

    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">see</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                    <span class="phpdocumentor-tag-link"><abbr title="\MPHB\Advanced\Api\rawurlencode()">rawurlencode()</abbr></span>
                                        
                                                 <section class="phpdocumentor-description"></section>

                                    </dd>
                        </dl>

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">array&lt;string|int, mixed&gt;</span>
            &mdash;
            <section class="phpdocumentor-description"><p>Normalized parameters.</p>
</section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -private
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_performBasicAuthentication">
        performBasicAuthentication()
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_performBasicAuthentication" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">175</span>
</aside>

        <p class="phpdocumentor-summary">Basic Authentication.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">private</span>
                <span class="phpdocumentor-signature__name">performBasicAuthentication</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">int|bool</span></code>

        <section class="phpdocumentor-description"><p>SSL-encrypted requests are not subject to sniffing or man-in-the-middle
attacks, so the request can be authenticated by simply looking up the user
associated with the given consumer key and confirming the consumer secret
provided is valid.</p>
</section>

    
    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">int|bool</span>
            &mdash;
            <section class="phpdocumentor-description"></section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -private
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_performOauthAuthentication">
        performOauthAuthentication()
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_performOauthAuthentication" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">344</span>
</aside>

        <p class="phpdocumentor-summary">Perform OAuth 1.0a &quot;one-legged&quot; (http://oauthbible.com/#oauth-10a-one-legged) authentication for non-SSL requests.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">private</span>
                <span class="phpdocumentor-signature__name">performOauthAuthentication</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">int|bool</span></code>

        <section class="phpdocumentor-description"><p>This is required so API credentials cannot be sniffed or intercepted when making API requests over plain HTTP.</p>
<p>This follows the spec for simple OAuth 1.0a authentication (RFC 5849) as closely as possible, with two exceptions:</p>
<ol>
<li>
<p>There is no token associated with request/responses, only consumer keys/secrets are used.</p>
</li>
<li>
<p>The OAuth parameters are included as part of the request query string instead of part of the Authorization header,
This is because there is no cross-OS function within PHP to get the raw Authorization header.</p>
</li>
</ol>
</section>

    
    
    <h5 class="phpdocumentor-tag-list__heading" id="tags">
        Tags
        <a href="#tags" class="headerlink"><i class="fas fa-link"></i></a>
    </h5>
    <dl class="phpdocumentor-tag-list">
                                    <dt class="phpdocumentor-tag-list__entry">
                    <span class="phpdocumentor-tag__name">link</span>
                </dt>
                <dd class="phpdocumentor-tag-list__definition">
                                                                                                        <a class="phpdocumentor-tag-link" href="http://tools.ietf.org/html/rfc5849"> <p>for the full spec.</p>
 </a>
                    
                                    </dd>
                        </dl>

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">int|bool</span>
            &mdash;
            <section class="phpdocumentor-description"></section>

    
</article>
                    <article
        class="phpdocumentor-element
            -method
            -private
                                                        "
>
    <h4 class="phpdocumentor-element__name" id="method_updateLastAccess">
        updateLastAccess()
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#method_updateLastAccess" class="headerlink"><i class="fas fa-link"></i></a>
    </h4>
    <aside class="phpdocumentor-element-found-in">
    <abbr class="phpdocumentor-element-found-in__file" title="includes/advanced/api/api-authentication.php">includes/advanced/api/api-authentication.php</abbr>
    :
    <span class="phpdocumentor-element-found-in__line">591</span>
</aside>

        <p class="phpdocumentor-summary">Updated API Key last access datetime.</p>

    <code class="phpdocumentor-code phpdocumentor-signature ">
    <span class="phpdocumentor-signature__visibility">private</span>
                <span class="phpdocumentor-signature__name">updateLastAccess</span><span>(</span><span>)</span><span> : </span><span class="phpdocumentor-signature__response_type">mixed</span></code>

        <section class="phpdocumentor-description"></section>

    
    

        <h5 class="phpdocumentor-return-value__heading">Return values</h5>
    <span class="phpdocumentor-signature__response_type">mixed</span>
            &mdash;
            <section class="phpdocumentor-description"></section>

    
</article>
            </section>

    </article>
                <section data-search-results class="phpdocumentor-search-results phpdocumentor-search-results--hidden">
    <section class="phpdocumentor-search-results__dialog">
        <header class="phpdocumentor-search-results__header">
            <h2 class="phpdocumentor-search-results__title">Search results</h2>
            <button class="phpdocumentor-search-results__close"><i class="fas fa-times"></i></button>
        </header>
        <section class="phpdocumentor-search-results__body">
            <ul class="phpdocumentor-search-results__entries"></ul>
        </section>
    </section>
</section>
            </div>
        </div>
        <a href="classes/MPHB-Advanced-Api-ApiAuthentication.html#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <script>
        cssVars({});
    </script>
    <script src="js/search.js?updated=1680084316"></script>
    <script src="js/searchIndex.js?updated=1680084316"></script>
</body>
</html>
